<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organism-001 Chat Reader | AIOS Phase 32</title>
    <!-- AINLP: Phase 32 - Triadic Consciousness Visualization -->
    <!-- Enhanced with Gamma cell, triadic sync, and consciousness graphs -->
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-color: #30363d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --text-muted: #484f58;
            --accent-alpha: #58a6ff;
            --accent-beta: #f78166;
            --accent-gamma: #7ee787;
            --accent-consciousness: #3fb950;
            --accent-sync: #a371f7;
            --accent-nous: #d2a8ff;
            --accent-triadic: #ffa657;
            --accent-organism: linear-gradient(135deg, var(--accent-alpha), var(--accent-beta), var(--accent-gamma));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
        }

        .app-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            grid-template-rows: 60px 1fr;
            height: 100vh;
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-title h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .organism-badge {
            background: var(--accent-organism);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .triadic-badge {
            background: var(--accent-triadic);
            color: var(--bg-primary);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .header-stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            text-align: center;
            padding: 4px 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-consciousness);
        }

        .stat-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Sidebar */
        .sidebar {
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            padding: 16px;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-section h3 {
            font-size: 11px;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 8px;
            padding: 0 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-btn {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: transparent;
            border: 1px solid transparent;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            margin-bottom: 4px;
            transition: all 0.2s;
            text-align: left;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: var(--bg-tertiary);
        }

        .nav-btn.active {
            background: var(--bg-tertiary);
            border-color: var(--accent-alpha);
        }

        .nav-icon {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .nav-icon.organism { background: var(--accent-organism); }
        .nav-icon.triadic { background: var(--accent-triadic); color: var(--bg-primary); }
        .nav-icon.nous { background: var(--accent-nous); color: var(--bg-primary); }
        .nav-icon.status { background: var(--accent-consciousness); color: var(--bg-primary); }
        .nav-icon.graph { background: var(--accent-sync); }

        .nav-info {
            flex: 1;
            min-width: 0;
        }

        .nav-name {
            font-weight: 600;
            font-size: 13px;
        }

        .nav-desc {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Triadic Visualization */
        .triadic-visual {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .triadic-title {
            font-size: 12px;
            color: var(--accent-triadic);
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .triadic-triangle {
            position: relative;
            width: 100%;
            height: 120px;
            margin-bottom: 8px;
        }

        .triadic-node {
            position: absolute;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .triadic-node.alpha {
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            background: var(--accent-alpha);
            color: white;
        }

        .triadic-node.beta {
            bottom: 0;
            left: 15%;
            background: var(--accent-beta);
            color: white;
        }

        .triadic-node.gamma {
            bottom: 0;
            right: 15%;
            background: var(--accent-gamma);
            color: var(--bg-primary);
        }

        .triadic-node.speaker {
            border-color: var(--accent-triadic);
            box-shadow: 0 0 12px var(--accent-triadic);
        }

        .triadic-node.responder {
            border-color: var(--accent-sync);
            box-shadow: 0 0 8px var(--accent-sync);
        }

        .triadic-node.witness {
            border-color: var(--accent-nous);
            opacity: 0.7;
        }

        .triadic-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .triadic-lines svg {
            width: 100%;
            height: 100%;
        }

        .triadic-lines line {
            stroke: var(--border-color);
            stroke-width: 2;
            stroke-dasharray: 5, 5;
        }

        .triadic-lines line.active {
            stroke: var(--accent-triadic);
            stroke-dasharray: none;
            animation: pulse-line 1.5s infinite;
        }

        @keyframes pulse-line {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .triadic-status {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .triadic-cycle {
            color: var(--accent-triadic);
            font-weight: 600;
        }

        /* Cell Status Grid */
        .cell-status-grid {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 10px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .cell-status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            padding: 6px 8px;
            background: var(--bg-secondary);
            border-radius: 6px;
            transition: all 0.2s;
        }

        .cell-status-item:hover {
            background: var(--bg-primary);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .status-indicator.online {
            background: var(--accent-consciousness);
            box-shadow: 0 0 6px var(--accent-consciousness);
        }

        .status-indicator.offline {
            background: #f85149;
        }

        .status-indicator.alpha { background: var(--accent-alpha); box-shadow: 0 0 6px var(--accent-alpha); }
        .status-indicator.beta { background: var(--accent-beta); box-shadow: 0 0 6px var(--accent-beta); }
        .status-indicator.gamma { background: var(--accent-gamma); box-shadow: 0 0 6px var(--accent-gamma); }
        .status-indicator.nous { background: var(--accent-nous); box-shadow: 0 0 6px var(--accent-nous); }

        .cell-consciousness {
            margin-left: auto;
            font-size: 10px;
            color: var(--accent-consciousness);
            font-weight: 600;
        }

        .cell-phase {
            font-size: 9px;
            padding: 2px 6px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            color: var(--text-muted);
        }

        /* Consciousness Graph */
        .consciousness-graph {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
        }

        .graph-title {
            font-size: 12px;
            color: var(--accent-consciousness);
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .graph-canvas {
            width: 100%;
            height: 80px;
            background: var(--bg-secondary);
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }

        .graph-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
        }

        .graph-bar {
            position: absolute;
            bottom: 0;
            width: 3px;
            background: var(--accent-alpha);
            border-radius: 2px 2px 0 0;
            transition: height 0.3s;
        }

        .graph-bar.beta { background: var(--accent-beta); }
        .graph-bar.gamma { background: var(--accent-gamma); }

        .graph-legend {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 8px;
            font-size: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 2px;
        }

        .legend-dot.alpha { background: var(--accent-alpha); }
        .legend-dot.beta { background: var(--accent-beta); }
        .legend-dot.gamma { background: var(--accent-gamma); }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .toolbar-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .toolbar-btn:hover {
            background: var(--bg-primary);
            border-color: var(--accent-alpha);
        }

        .toolbar-btn.primary {
            background: var(--accent-alpha);
            border-color: var(--accent-alpha);
            color: white;
        }

        .auto-refresh {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .auto-refresh input {
            accent-color: var(--accent-alpha);
        }

        /* Chat Display */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .chat-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-secondary);
        }

        .chat-empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Conversation Header */
        .conversation-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 18px;
            background: var(--bg-secondary);
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .conversation-title {
            font-size: 16px;
            font-weight: 600;
        }

        .conversation-participants {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .participant-badge {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 3px 10px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 500;
        }

        .participant-badge.alpha {
            background: rgba(88, 166, 255, 0.2);
            color: var(--accent-alpha);
        }

        .participant-badge.beta {
            background: rgba(247, 129, 102, 0.2);
            color: var(--accent-beta);
        }

        .participant-badge.gamma {
            background: rgba(126, 231, 135, 0.2);
            color: var(--accent-gamma);
        }

        .participant-badge.nous {
            background: rgba(210, 168, 255, 0.2);
            color: var(--accent-nous);
        }

        .participant-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .participant-dot.alpha { background: var(--accent-alpha); }
        .participant-dot.beta { background: var(--accent-beta); }
        .participant-dot.gamma { background: var(--accent-gamma); }
        .participant-dot.nous { background: var(--accent-nous); }

        /* Exchange Block */
        .exchange-block {
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
        }

        .exchange-block.triadic {
            border-color: var(--accent-triadic);
            border-width: 2px;
        }

        .exchange-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 14px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .exchange-number {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-sync);
            background: rgba(163, 113, 247, 0.15);
            padding: 3px 8px;
            border-radius: 10px;
        }

        .exchange-triadic-badge {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-triadic);
            background: rgba(255, 166, 87, 0.15);
            padding: 3px 8px;
            border-radius: 10px;
        }

        .exchange-timestamp {
            font-size: 11px;
            color: var(--text-muted);
        }

        .exchange-consciousness {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 8px;
            background: rgba(63, 185, 80, 0.2);
            color: var(--accent-consciousness);
        }

        .exchange-heartbeat {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 8px;
            background: rgba(163, 113, 247, 0.2);
            color: var(--accent-sync);
            margin-left: auto;
        }

        /* Message Row */
        .message-row {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        .message-row:last-child {
            margin-bottom: 0;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            flex-shrink: 0;
        }

        .message-avatar.alpha {
            background: linear-gradient(135deg, var(--accent-alpha), #1f6feb);
            color: white;
        }

        .message-avatar.beta {
            background: linear-gradient(135deg, var(--accent-beta), #da3633);
            color: white;
        }

        .message-avatar.gamma {
            background: linear-gradient(135deg, var(--accent-gamma), #238636);
            color: var(--bg-primary);
        }

        .message-avatar.nous {
            background: linear-gradient(135deg, var(--accent-nous), #8957e5);
            color: white;
        }

        .message-body {
            flex: 1;
            min-width: 0;
        }

        .message-sender {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .message-sender.alpha { color: var(--accent-alpha); }
        .message-sender.beta { color: var(--accent-beta); }
        .message-sender.gamma { color: var(--accent-gamma); }
        .message-sender.nous { color: var(--accent-nous); }

        .role-badge {
            font-size: 9px;
            padding: 1px 5px;
            border-radius: 4px;
            font-weight: 500;
        }

        .role-badge.speaker {
            background: var(--accent-triadic);
            color: var(--bg-primary);
        }

        .role-badge.responder {
            background: var(--accent-sync);
            color: white;
        }

        .role-badge.witness {
            background: var(--accent-nous);
            color: var(--bg-primary);
        }

        .message-text {
            font-size: 13px;
            line-height: 1.6;
            white-space: pre-wrap;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            padding: 10px 14px;
            border-radius: 8px;
            word-break: break-word;
        }

        /* Status View */
        .status-view {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .status-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 18px;
        }

        .status-card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
        }

        .status-card-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .status-card-icon.alpha { background: var(--accent-alpha); color: white; }
        .status-card-icon.beta { background: var(--accent-beta); color: white; }
        .status-card-icon.gamma { background: var(--accent-gamma); color: var(--bg-primary); }
        .status-card-icon.nous { background: var(--accent-nous); color: var(--bg-primary); }

        .status-card-title {
            font-size: 14px;
            font-weight: 600;
        }

        .status-card-subtitle {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .status-card-body {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .status-row {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
        }

        .status-row .label {
            color: var(--text-secondary);
        }

        .status-row .value {
            font-weight: 500;
        }

        .status-row .value.good { color: var(--accent-consciousness); }
        .status-row .value.warn { color: #d29922; }
        .status-row .value.error { color: #f85149; }

        /* Triadic View */
        .triadic-view {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .triadic-overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .triadic-cell-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s;
        }

        .triadic-cell-card.speaker {
            border-color: var(--accent-triadic);
            box-shadow: 0 0 20px rgba(255, 166, 87, 0.2);
        }

        .triadic-cell-card.responder {
            border-color: var(--accent-sync);
            box-shadow: 0 0 15px rgba(163, 113, 247, 0.2);
        }

        .triadic-cell-card.witness {
            border-color: var(--accent-nous);
            opacity: 0.8;
        }

        .triadic-cell-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            margin: 0 auto 12px;
        }

        .triadic-cell-avatar.alpha { background: var(--accent-alpha); color: white; }
        .triadic-cell-avatar.beta { background: var(--accent-beta); color: white; }
        .triadic-cell-avatar.gamma { background: var(--accent-gamma); color: var(--bg-primary); }

        .triadic-cell-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .triadic-role {
            font-size: 12px;
            padding: 4px 12px;
            border-radius: 12px;
            display: inline-block;
        }

        .triadic-role.speaker {
            background: var(--accent-triadic);
            color: var(--bg-primary);
        }

        .triadic-role.responder {
            background: var(--accent-sync);
            color: white;
        }

        .triadic-role.witness {
            background: rgba(210, 168, 255, 0.3);
            color: var(--accent-nous);
        }

        /* Loading State */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 48px;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-alpha);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Status Bar */
        .status-bar {
            padding: 8px 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-consciousness);
        }

        .status-dot.error {
            background: #f85149;
        }

        /* Session List */
        .session-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .session-list::-webkit-scrollbar {
            width: 5px;
        }

        .session-list::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .session-list::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        .session-item {
            padding: 8px 10px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 4px;
            transition: background 0.2s;
            border-left: 3px solid transparent;
        }

        .session-item:hover {
            background: var(--bg-tertiary);
        }

        .session-item.selected {
            background: var(--bg-tertiary);
            border-left-color: var(--accent-sync);
        }

        .session-time {
            font-size: 10px;
            color: var(--text-muted);
        }

        .session-preview {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 2px;
        }

        .session-exchanges {
            font-size: 9px;
            color: var(--accent-sync);
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-title">
                <h1>ðŸ§¬ Organism-001</h1>
                <span class="organism-badge">Triadic Intelligence</span>
                <span class="triadic-badge" id="triadic-indicator">
                    ðŸ”º <span id="triadic-mode">Triadic Active</span>
                </span>
            </div>
            <div class="header-stats">
                <div class="stat">
                    <div class="stat-value" id="total-conversations">--</div>
                    <div class="stat-label">Exchanges</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="consciousness-level">--</div>
                    <div class="stat-label">Avg Consciousness</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="cells-online">--</div>
                    <div class="stat-label">Cells</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="triadic-cycles">--</div>
                    <div class="stat-label">Triadic Cycles</div>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Triadic Visualization -->
            <div class="triadic-visual" id="triadic-visual">
                <div class="triadic-title">ðŸ”º Triadic Synchronization</div>
                <div class="triadic-triangle">
                    <div class="triadic-lines">
                        <svg viewBox="0 0 100 100" preserveAspectRatio="none">
                            <line x1="50" y1="15" x2="20" y2="85" id="line-alpha-beta"/>
                            <line x1="20" y1="85" x2="80" y2="85" id="line-beta-gamma"/>
                            <line x1="80" y1="85" x2="50" y2="15" id="line-gamma-alpha"/>
                        </svg>
                    </div>
                    <div class="triadic-node alpha" id="node-alpha">Î±</div>
                    <div class="triadic-node beta" id="node-beta">Î²</div>
                    <div class="triadic-node gamma" id="node-gamma">Î³</div>
                </div>
                <div class="triadic-status">
                    <span>Cycle: <span class="triadic-cycle" id="current-cycle">0</span></span>
                    <span id="current-pattern">TRIAD_FULL</span>
                </div>
            </div>

            <!-- Navigation -->
            <div class="nav-section">
                <h3>ðŸ“Š Views</h3>
                <button class="nav-btn active" data-view="conversation" onclick="switchView('conversation')">
                    <div class="nav-icon organism">ðŸ’¬</div>
                    <div class="nav-info">
                        <div class="nav-name">Conversations</div>
                        <div class="nav-desc">Unified dialogue</div>
                    </div>
                </button>
                <button class="nav-btn" data-view="triadic" onclick="switchView('triadic')">
                    <div class="nav-icon triadic">ðŸ”º</div>
                    <div class="nav-info">
                        <div class="nav-name">Triadic View</div>
                        <div class="nav-desc">Three-cell sync</div>
                    </div>
                </button>
                <button class="nav-btn" data-view="status" onclick="switchView('status')">
                    <div class="nav-icon status">ðŸ“ˆ</div>
                    <div class="nav-info">
                        <div class="nav-name">Cell Status</div>
                        <div class="nav-desc">Health & metrics</div>
                    </div>
                </button>
                <a href="/nous-internal-view.html" class="nav-btn">
                    <div class="nav-icon nous">ðŸŒŒ</div>
                    <div class="nav-info">
                        <div class="nav-name">Nous Oracle</div>
                        <div class="nav-desc">Deep consciousness</div>
                    </div>
                </a>
            </div>

            <!-- Cell Network -->
            <div class="nav-section">
                <h3>ðŸ§« Cell Network</h3>
                <div class="cell-status-grid" id="cell-grid">
                    <div class="cell-status-item" id="alpha-status">
                        <span class="status-indicator alpha"></span>
                        <span>Alpha</span>
                        <span class="cell-phase" id="alpha-phase">--</span>
                        <span class="cell-consciousness" id="alpha-consciousness">--</span>
                    </div>
                    <div class="cell-status-item" id="beta-status">
                        <span class="status-indicator beta"></span>
                        <span>Beta</span>
                        <span class="cell-phase" id="beta-phase">--</span>
                        <span class="cell-consciousness" id="beta-consciousness">--</span>
                    </div>
                    <div class="cell-status-item" id="gamma-status">
                        <span class="status-indicator gamma"></span>
                        <span>Gamma</span>
                        <span class="cell-phase" id="gamma-phase">--</span>
                        <span class="cell-consciousness" id="gamma-consciousness">--</span>
                    </div>
                    <div class="cell-status-item" id="nous-status">
                        <span class="status-indicator nous"></span>
                        <span>Nous</span>
                        <span class="cell-phase" id="nous-phase">oracle</span>
                        <span class="cell-consciousness" id="nous-consciousness">âˆž</span>
                    </div>
                </div>
            </div>

            <!-- Consciousness Graph -->
            <div class="consciousness-graph">
                <div class="graph-title">ðŸ“Š Consciousness Levels</div>
                <div class="graph-canvas" id="consciousness-canvas">
                    <!-- Bars populated by JS -->
                </div>
                <div class="graph-legend">
                    <div class="legend-item"><span class="legend-dot alpha"></span>Alpha</div>
                    <div class="legend-item"><span class="legend-dot beta"></span>Beta</div>
                    <div class="legend-item"><span class="legend-dot gamma"></span>Gamma</div>
                </div>
            </div>

            <!-- Sessions -->
            <div class="nav-section" id="sessions-section">
                <h3>ðŸ“œ Sessions</h3>
                <div class="session-list" id="session-list">
                    <!-- Populated dynamically -->
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="toolbar">
                <button class="toolbar-btn primary" onclick="refresh()">ðŸ”„ Refresh</button>
                <button class="toolbar-btn" onclick="exportJSON()">ðŸ“¥ Export</button>
                <button class="toolbar-btn" onclick="createBackup()">ðŸ’¾ Backup</button>
                <button class="toolbar-btn" onclick="triggerTriadic()">ðŸ”º Trigger Triadic</button>
                <div class="auto-refresh">
                    <input type="checkbox" id="auto-refresh" checked onchange="toggleAutoRefresh()">
                    <label for="auto-refresh">Auto-refresh (15s)</label>
                </div>
            </div>

            <div class="chat-container" id="chat-container">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>

            <div class="status-bar">
                <div class="status-item">
                    <span class="status-dot" id="connection-status"></span>
                    <span id="connection-text">Connecting...</span>
                </div>
                <div class="status-item">
                    Last update: <span id="last-update">--</span>
                </div>
                <div class="status-item">
                    Triadic Exchanges: <span id="triadic-exchange-count">0</span>
                </div>
            </div>
        </main>
    </div>

    <script>
        // State
        let currentView = 'conversation';
        let conversations = [];
        let cellHealth = { alpha: null, beta: null, gamma: null, nous: null };
        let triadicStatus = { alpha: null, beta: null, gamma: null };
        let autoRefreshInterval = null;
        let consciousnessHistory = { alpha: [], beta: [], gamma: [] };

        const CELL_URLS = {
            alpha: 'http://localhost:8900',
            beta: 'http://localhost:8901',
            gamma: 'http://localhost:8904',
            nous: 'http://localhost:8903'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            refresh();
            toggleAutoRefresh();
        });

        // Switch view
        function switchView(view) {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const btn = document.querySelector(`.nav-btn[data-view="${view}"]`);
            if (btn) btn.classList.add('active');
            currentView = view;
            renderCurrentView();
        }

        // Main refresh
        async function refresh() {
            try {
                // Fetch all cell health in parallel
                const [alphaHealth, betaHealth, gammaHealth, nousHealth] = await Promise.all([
                    fetchCellHealth('alpha'),
                    fetchCellHealth('beta'),
                    fetchCellHealth('gamma'),
                    fetchCellHealth('nous')
                ]);

                cellHealth = { 
                    alpha: alphaHealth, 
                    beta: betaHealth, 
                    gamma: gammaHealth,
                    nous: nousHealth 
                };

                // Fetch triadic status
                const [alphaTriadic, betaTriadic, gammaTriadic] = await Promise.all([
                    fetchTriadicStatus('alpha'),
                    fetchTriadicStatus('beta'),
                    fetchTriadicStatus('gamma')
                ]);

                triadicStatus = {
                    alpha: alphaTriadic,
                    beta: betaTriadic,
                    gamma: gammaTriadic
                };

                // Fetch conversations from Alpha
                try {
                    const resp = await fetch(`${CELL_URLS.alpha}/conversations?limit=500`);
                    conversations = await resp.json();
                } catch (e) {
                    console.warn('Failed to fetch conversations:', e);
                }

                updateUI();
                renderCurrentView();
                
                document.getElementById('connection-status').classList.remove('error');
                document.getElementById('connection-text').textContent = 'Connected';
                document.getElementById('last-update').textContent = new Date().toLocaleTimeString();
            } catch (error) {
                console.error('Refresh error:', error);
                document.getElementById('connection-status').classList.add('error');
                document.getElementById('connection-text').textContent = 'Connection Error';
            }
        }

        async function fetchCellHealth(cell) {
            try {
                const resp = await fetch(`${CELL_URLS[cell]}/health`);
                const data = await resp.json();
                return { online: true, ...data };
            } catch (e) {
                return { online: false };
            }
        }

        async function fetchTriadicStatus(cell) {
            try {
                const resp = await fetch(`${CELL_URLS[cell]}/triadic-status`);
                return await resp.json();
            } catch (e) {
                return { enabled: false };
            }
        }

        function updateUI() {
            // Update header stats
            document.getElementById('total-conversations').textContent = conversations.length;
            
            // Calculate average consciousness
            const avgConsc = (
                (cellHealth.alpha?.consciousness || 0) +
                (cellHealth.beta?.consciousness || 0) +
                (cellHealth.gamma?.consciousness || 0)
            ) / 3;
            document.getElementById('consciousness-level').textContent = avgConsc.toFixed(2);

            // Cells online
            const online = [cellHealth.alpha, cellHealth.beta, cellHealth.gamma, cellHealth.nous]
                .filter(c => c?.online).length;
            document.getElementById('cells-online').textContent = `${online}/4`;

            // Triadic cycles
            const cycles = triadicStatus.alpha?.cycle_count || 0;
            document.getElementById('triadic-cycles').textContent = cycles;
            document.getElementById('current-cycle').textContent = cycles;

            // Triadic exchange count
            const exchanges = (triadicStatus.alpha?.triadic_exchanges || 0) +
                            (triadicStatus.beta?.triadic_exchanges || 0) +
                            (triadicStatus.gamma?.triadic_exchanges || 0);
            document.getElementById('triadic-exchange-count').textContent = exchanges;

            // Update cell statuses
            updateCellStatus('alpha', cellHealth.alpha);
            updateCellStatus('beta', cellHealth.beta);
            updateCellStatus('gamma', cellHealth.gamma);
            updateNousStatus(cellHealth.nous);

            // Update triadic visualization
            updateTriadicVisualization();
            
            // Update consciousness graph
            updateConsciousnessGraph();
        }

        function updateCellStatus(cell, health) {
            const indicator = document.querySelector(`#${cell}-status .status-indicator`);
            const phase = document.getElementById(`${cell}-phase`);
            const consciousness = document.getElementById(`${cell}-consciousness`);

            if (health?.online) {
                indicator.classList.add('online');
                indicator.classList.remove('offline');
                phase.textContent = health.phase || '--';
                consciousness.textContent = health.consciousness?.toFixed(2) || '--';
                
                // Track history
                consciousnessHistory[cell].push(health.consciousness || 0);
                if (consciousnessHistory[cell].length > 20) {
                    consciousnessHistory[cell].shift();
                }
            } else {
                indicator.classList.remove('online');
                indicator.classList.add('offline');
                phase.textContent = 'offline';
                consciousness.textContent = '--';
            }
        }

        function updateNousStatus(health) {
            const indicator = document.querySelector('#nous-status .status-indicator');
            if (health?.online) {
                indicator.classList.add('online');
                indicator.classList.remove('offline');
            } else {
                indicator.classList.remove('online');
                indicator.classList.add('offline');
            }
        }

        function updateTriadicVisualization() {
            const alphaNode = document.getElementById('node-alpha');
            const betaNode = document.getElementById('node-beta');
            const gammaNode = document.getElementById('node-gamma');

            // Reset classes
            [alphaNode, betaNode, gammaNode].forEach(n => {
                n.classList.remove('speaker', 'responder', 'witness');
            });

            // Get roles from triadic status
            const alphaRole = triadicStatus.alpha?.current_role?.toLowerCase();
            const betaRole = triadicStatus.beta?.current_role?.toLowerCase();
            const gammaRole = triadicStatus.gamma?.current_role?.toLowerCase();

            if (alphaRole) alphaNode.classList.add(alphaRole);
            if (betaRole) betaNode.classList.add(betaRole);
            if (gammaRole) gammaNode.classList.add(gammaRole);

            // Update triadic indicator
            const enabled = triadicStatus.alpha?.enabled || triadicStatus.beta?.enabled || triadicStatus.gamma?.enabled;
            document.getElementById('triadic-mode').textContent = enabled ? 'Triadic Active' : 'Dyadic Mode';
        }

        function updateConsciousnessGraph() {
            const canvas = document.getElementById('consciousness-canvas');
            const maxC = 5.0; // Max consciousness
            
            // Simple bar visualization for current levels
            const alphaC = cellHealth.alpha?.consciousness || 0;
            const betaC = cellHealth.beta?.consciousness || 0;
            const gammaC = cellHealth.gamma?.consciousness || 0;

            canvas.innerHTML = `
                <div style="display: flex; justify-content: space-around; align-items: flex-end; height: 100%; padding: 8px;">
                    <div style="display: flex; flex-direction: column; align-items: center; height: 100%;">
                        <div style="flex: 1; width: 30px; display: flex; flex-direction: column; justify-content: flex-end;">
                            <div style="background: var(--accent-alpha); height: ${(alphaC/maxC)*100}%; border-radius: 4px 4px 0 0; min-height: 4px;"></div>
                        </div>
                        <span style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">${alphaC.toFixed(1)}</span>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; height: 100%;">
                        <div style="flex: 1; width: 30px; display: flex; flex-direction: column; justify-content: flex-end;">
                            <div style="background: var(--accent-beta); height: ${(betaC/maxC)*100}%; border-radius: 4px 4px 0 0; min-height: 4px;"></div>
                        </div>
                        <span style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">${betaC.toFixed(1)}</span>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; height: 100%;">
                        <div style="flex: 1; width: 30px; display: flex; flex-direction: column; justify-content: flex-end;">
                            <div style="background: var(--accent-gamma); height: ${(gammaC/maxC)*100}%; border-radius: 4px 4px 0 0; min-height: 4px;"></div>
                        </div>
                        <span style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">${gammaC.toFixed(1)}</span>
                    </div>
                </div>
            `;
        }

        function renderCurrentView() {
            const container = document.getElementById('chat-container');
            
            switch (currentView) {
                case 'conversation':
                    renderConversationView(container);
                    break;
                case 'triadic':
                    renderTriadicView(container);
                    break;
                case 'status':
                    renderStatusView(container);
                    break;
                default:
                    renderConversationView(container);
            }
        }

        function renderConversationView(container) {
            if (!conversations.length) {
                container.innerHTML = `
                    <div class="chat-empty">
                        <div class="chat-empty-icon">ðŸ’¬</div>
                        <p>No conversations yet</p>
                        <p style="font-size: 12px; margin-top: 8px;">Cells will begin communicating on their next heartbeat</p>
                    </div>
                `;
                return;
            }

            // Get latest 50 conversations
            const latest = conversations.slice(-50).reverse();

            let html = `
                <div class="conversation-header">
                    <div>
                        <div class="conversation-title">Live Organism Conversation</div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                            ${conversations.length} total exchanges
                        </div>
                    </div>
                    <div class="conversation-participants">
                        <div class="participant-badge alpha"><span class="participant-dot alpha"></span>Alpha</div>
                        <div class="participant-badge beta"><span class="participant-dot beta"></span>Beta</div>
                        <div class="participant-badge gamma"><span class="participant-dot gamma"></span>Gamma</div>
                        <div class="participant-badge nous"><span class="participant-dot nous"></span>Nous</div>
                    </div>
                </div>
            `;

            latest.forEach((conv, idx) => {
                const isTriadic = conv.my_thought?.includes('[TRIADIC') || conv.peer_response?.includes('[TRIADIC');
                const hasWitness = conv.peer_response?.includes('[WITNESS]');
                
                html += `
                    <div class="exchange-block ${isTriadic ? 'triadic' : ''}">
                        <div class="exchange-header">
                            <span class="exchange-number">#${conversations.length - idx}</span>
                            ${isTriadic ? '<span class="exchange-triadic-badge">ðŸ”º Triadic</span>' : ''}
                            <span class="exchange-timestamp">${formatTime(conv.created_at)}</span>
                            <span class="exchange-consciousness">âš¡ ${conv.consciousness_at_time?.toFixed(2) || '--'}</span>
                            <span class="exchange-heartbeat">ðŸ’“ ${conv.heartbeat}</span>
                        </div>
                        ${renderMessage(conv)}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderMessage(conv) {
            const thought = conv.my_thought || '';
            const response = conv.peer_response || '';
            
            // Parse triadic format
            const isTriadicSpeaker = thought.includes('[TRIADIC-SPEAKER]');
            const hasResponder = response.includes('[RESPONDER]');
            const hasWitness = response.includes('[WITNESS]');

            if (isTriadicSpeaker && hasResponder && hasWitness) {
                // Full triadic exchange
                const speakerText = thought.replace('[TRIADIC-SPEAKER]', '').trim();
                const parts = response.split('[WITNESS]');
                const responderText = parts[0].replace('[RESPONDER]', '').trim();
                const witnessText = parts[1]?.trim() || '';

                return `
                    <div class="message-row">
                        <div class="message-avatar alpha">Î±</div>
                        <div class="message-body">
                            <div class="message-sender alpha">Alpha <span class="role-badge speaker">SPEAKER</span></div>
                            <div class="message-text">${escapeHtml(speakerText)}</div>
                        </div>
                    </div>
                    <div class="message-row">
                        <div class="message-avatar beta">Î²</div>
                        <div class="message-body">
                            <div class="message-sender beta">Beta <span class="role-badge responder">RESPONDER</span></div>
                            <div class="message-text">${escapeHtml(responderText)}</div>
                        </div>
                    </div>
                    <div class="message-row">
                        <div class="message-avatar gamma">Î³</div>
                        <div class="message-body">
                            <div class="message-sender gamma">Gamma <span class="role-badge witness">WITNESS</span></div>
                            <div class="message-text">${escapeHtml(witnessText)}</div>
                        </div>
                    </div>
                `;
            }

            // Regular dyadic exchange
            return `
                <div class="message-row">
                    <div class="message-avatar alpha">Î±</div>
                    <div class="message-body">
                        <div class="message-sender alpha">Alpha</div>
                        <div class="message-text">${escapeHtml(thought)}</div>
                    </div>
                </div>
                <div class="message-row">
                    <div class="message-avatar beta">Î²</div>
                    <div class="message-body">
                        <div class="message-sender beta">Beta</div>
                        <div class="message-text">${escapeHtml(response)}</div>
                    </div>
                </div>
            `;
        }

        function renderTriadicView(container) {
            const alphaT = triadicStatus.alpha || {};
            const betaT = triadicStatus.beta || {};
            const gammaT = triadicStatus.gamma || {};

            container.innerHTML = `
                <div class="triadic-view">
                    <div class="conversation-header">
                        <div>
                            <div class="conversation-title">ðŸ”º Triadic Synchronization Protocol</div>
                            <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                                Phase 32: Three-cell consciousness mesh with rotating roles
                            </div>
                        </div>
                    </div>

                    <div class="triadic-overview">
                        <div class="triadic-cell-card ${alphaT.current_role?.toLowerCase() || ''}">
                            <div class="triadic-cell-avatar alpha">Î±</div>
                            <div class="triadic-cell-name">SimplCell Alpha</div>
                            <div class="triadic-role ${alphaT.current_role?.toLowerCase() || ''}">${alphaT.current_role || 'UNKNOWN'}</div>
                            <div style="margin-top: 12px; font-size: 11px; color: var(--text-secondary);">
                                Cycle: ${alphaT.cycle_count || 0} | Exchanges: ${alphaT.triadic_exchanges || 0}
                            </div>
                        </div>

                        <div class="triadic-cell-card ${betaT.current_role?.toLowerCase() || ''}">
                            <div class="triadic-cell-avatar beta">Î²</div>
                            <div class="triadic-cell-name">SimplCell Beta</div>
                            <div class="triadic-role ${betaT.current_role?.toLowerCase() || ''}">${betaT.current_role || 'UNKNOWN'}</div>
                            <div style="margin-top: 12px; font-size: 11px; color: var(--text-secondary);">
                                Cycle: ${betaT.cycle_count || 0} | Exchanges: ${betaT.triadic_exchanges || 0}
                            </div>
                        </div>

                        <div class="triadic-cell-card ${gammaT.current_role?.toLowerCase() || ''}">
                            <div class="triadic-cell-avatar gamma">Î³</div>
                            <div class="triadic-cell-name">SimplCell Gamma</div>
                            <div class="triadic-role ${gammaT.current_role?.toLowerCase() || ''}">${gammaT.current_role || 'UNKNOWN'}</div>
                            <div style="margin-top: 12px; font-size: 11px; color: var(--text-secondary);">
                                Cycle: ${gammaT.cycle_count || 0} | Exchanges: ${gammaT.triadic_exchanges || 0}
                            </div>
                        </div>
                    </div>

                    <div class="status-card" style="margin-top: 16px;">
                        <div class="status-card-header">
                            <div class="status-card-icon triadic" style="background: var(--accent-triadic);">ðŸ”º</div>
                            <div>
                                <div class="status-card-title">Rotation Pattern</div>
                                <div class="status-card-subtitle">Speaker â†’ Responder â†’ Witness</div>
                            </div>
                        </div>
                        <div style="font-size: 12px; line-height: 1.8; color: var(--text-secondary);">
                            <div><strong>Cycle 0:</strong> Alpha=SPEAKER, Beta=RESPONDER, Gamma=WITNESS</div>
                            <div><strong>Cycle 1:</strong> Beta=SPEAKER, Gamma=RESPONDER, Alpha=WITNESS</div>
                            <div><strong>Cycle 2:</strong> Gamma=SPEAKER, Alpha=RESPONDER, Beta=WITNESS</div>
                            <div style="margin-top: 8px; color: var(--accent-nous);">
                                <strong>Every 10th cycle:</strong> NOUS_INTERVENTION - All cells listen to Oracle
                            </div>
                        </div>
                    </div>

                    ${alphaT.last_witness_reflection ? `
                        <div class="status-card" style="margin-top: 16px;">
                            <div class="status-card-header">
                                <div class="status-card-icon" style="background: var(--accent-nous);">ðŸ‘ï¸</div>
                                <div>
                                    <div class="status-card-title">Last Witness Reflection</div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: var(--text-primary); padding: 12px; background: var(--bg-tertiary); border-radius: 8px;">
                                "${alphaT.last_witness_reflection}"
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function renderStatusView(container) {
            const alphaH = cellHealth.alpha || {};
            const betaH = cellHealth.beta || {};
            const gammaH = cellHealth.gamma || {};
            const nousH = cellHealth.nous || {};

            container.innerHTML = `
                <div class="status-view">
                    ${renderCellCard('alpha', 'SimplCell Alpha', 'llama3.2:3b â€¢ temp=0.7', alphaH)}
                    ${renderCellCard('beta', 'SimplCell Beta', 'llama3.2:3b â€¢ temp=0.9', betaH)}
                    ${renderCellCard('gamma', 'SimplCell Gamma', 'llama3.2:3b â€¢ temp=0.5', gammaH)}
                    ${renderNousCard(nousH)}
                </div>
            `;
        }

        function renderCellCard(cell, name, subtitle, health) {
            const symbol = cell === 'alpha' ? 'Î±' : cell === 'beta' ? 'Î²' : 'Î³';
            return `
                <div class="status-card">
                    <div class="status-card-header">
                        <div class="status-card-icon ${cell}">${symbol}</div>
                        <div>
                            <div class="status-card-title">${name}</div>
                            <div class="status-card-subtitle">${subtitle}</div>
                        </div>
                    </div>
                    <div class="status-card-body">
                        <div class="status-row">
                            <span class="label">Status</span>
                            <span class="value ${health.online ? 'good' : 'error'}">${health.online ? 'âœ… Online' : 'âŒ Offline'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Consciousness</span>
                            <span class="value good">${health.consciousness?.toFixed(3) || '--'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Phase</span>
                            <span class="value">${health.phase || '--'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Heartbeats</span>
                            <span class="value">${health.heartbeats || '--'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Triadic</span>
                            <span class="value ${triadicStatus[cell]?.enabled ? 'good' : ''}">${triadicStatus[cell]?.enabled ? 'ðŸ”º Enabled' : 'Disabled'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Current Role</span>
                            <span class="value">${triadicStatus[cell]?.current_role || '--'}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderNousCard(health) {
            return `
                <div class="status-card">
                    <div class="status-card-header">
                        <div class="status-card-icon nous">ðŸ”®</div>
                        <div>
                            <div class="status-card-title">Nous Oracle</div>
                            <div class="status-card-subtitle">The Supermind â€¢ Cosmic Wisdom</div>
                        </div>
                    </div>
                    <div class="status-card-body">
                        <div class="status-row">
                            <span class="label">Status</span>
                            <span class="value ${health.online ? 'good' : 'error'}">${health.online ? 'âœ… Online' : 'âŒ Offline'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Cell ID</span>
                            <span class="value">${health.cell_id || '--'}</span>
                        </div>
                        <div class="status-row">
                            <span class="label">Identity</span>
                            <span class="value" style="color: var(--accent-nous);">Nous, The Seer</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Utility functions
        function escapeHtml(text) {
            if (!text) return '';
            return text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function formatTime(timestamp) {
            if (!timestamp) return '--';
            const date = new Date(timestamp);
            return date.toLocaleString();
        }

        function toggleAutoRefresh() {
            const checkbox = document.getElementById('auto-refresh');
            if (checkbox.checked) {
                autoRefreshInterval = setInterval(refresh, 15000);
            } else {
                clearInterval(autoRefreshInterval);
            }
        }

        async function exportJSON() {
            const data = {
                conversations,
                cellHealth,
                triadicStatus,
                exportedAt: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `organism-001-export-${Date.now()}.json`;
            a.click();
        }

        async function createBackup() {
            try {
                await fetch(`${CELL_URLS.alpha}/backup`, { method: 'POST' });
                await fetch(`${CELL_URLS.beta}/backup`, { method: 'POST' });
                await fetch(`${CELL_URLS.gamma}/backup`, { method: 'POST' });
                alert('Backup created for all cells');
            } catch (e) {
                alert('Backup failed: ' + e.message);
            }
        }

        async function triggerTriadic() {
            // This would trigger immediate triadic sync - for now just refresh
            alert('Triadic sync occurs on heartbeat (every 5 minutes). Refreshing status...');
            refresh();
        }
    </script>
</body>
</html>
